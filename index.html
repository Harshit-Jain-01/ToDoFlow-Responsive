<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TodoFlow ‚Äî Modern To-Do List</title>
  <style>
    :root {
      --bg:#f8fafc;         /* light mode background */
      --panel:#ffffff;      /* light card */
      --muted:#64748b;      /* slate-500 */
      --text:#1e293b;       /* gray-900 */
      --accent:#22c55e;     /* green-500 */
      --accent-2:#3b82f6;   /* blue-500 */
      --danger:#ef4444;     /* red-500 */
      --warn:#f59e0b;       /* amber-500 */
      --chip:#e2e8f0;       /* gray-200 */
      --border:#cbd5e1;     /* gray-300 */
    }
    body.dark {
      --bg:#0f172a;
      --panel:#1e293b;
      --muted:#94a3b8;
      --text:#f1f5f9;
      --chip:#1f2937;
      --border:#334155;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
      transition: background .3s, color .3s;
    }
    .container{max-width:900px; margin:30px auto; padding:0 16px;}
    header{display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px; margin-bottom:20px;}
    .brand{display:flex; align-items:center; gap:12px;}
    .logo{width:42px; height:42px; border-radius:12px; background:conic-gradient(from 210deg,var(--accent),var(--accent-2));}
    h1{margin:0; font-size:clamp(22px,3vw,28px);}
    .controls{display:flex; flex-wrap:wrap; gap:8px}
    .btn{
      background:var(--chip); color:var(--text); border:1px solid var(--border);
      padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600;
      transition:.2s background,.2s transform;
    }
    .btn:hover{transform:translateY(-1px);}
    .btn.primary{background:var(--accent); color:white; border:none;}
    .btn.danger{background:var(--danger); color:white; border:none;}
    .btn.warn{background:var(--warn); color:white; border:none;}
    .panel{background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,.05);}
    form.add{display:grid; grid-template-columns:2fr 1fr 120px 100px; gap:10px;}
    input, select{
      width:100%; padding:10px; border-radius:10px; border:1px solid var(--border); background:var(--chip); color:var(--text);
      outline:none;
    }
    input:focus, select:focus{border-color:var(--accent-2);}
    .list{margin-top:16px; display:flex; flex-direction:column; gap:12px;}
    .item{display:flex; flex-direction:column; gap:6px; background:var(--panel); padding:12px; border-radius:12px; border:1px solid var(--border); box-shadow:0 2px 6px rgba(0,0,0,.05);}
    .top-row{display:flex; align-items:center; gap:8px;}
    .checkbox{width:20px; height:20px; border-radius:6px; border:2px solid var(--border); display:inline-grid; place-items:center; cursor:pointer;}
    .checkbox.checked{background:var(--accent); border-color:var(--accent);}
    .title{font-weight:600; flex:1;}
    .title.done{text-decoration:line-through; color:var(--muted);}
    .meta{display:flex; justify-content:space-between; font-size:13px; color:var(--muted);}
    .actions{display:flex; gap:6px;}
    .filters{display:flex; flex-wrap:wrap; gap:8px; margin-top:14px; align-items:center;}
    .search{flex:1;}
    .empty{text-align:center; padding:24px; color:var(--muted);}
    footer{margin-top:20px; font-size:13px; color:var(--muted); display:flex; justify-content:space-between;}
    @media (max-width:700px){
      form.add{grid-template-columns:1fr; gap:8px;}
      .actions{flex-wrap:wrap;}
      .btn{flex:1;}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <h1>TodoFlow</h1>
      </div>
      <div class="controls">
        <button class="btn" id="toggleTheme">üåô Dark</button>
        <button class="btn" id="exportBtn">Export</button>
        <label class="btn">
          Import <input id="importFile" type="file" accept="application/json" hidden/>
        </label>
        <button class="btn warn" id="clearDoneBtn">Clear Done</button>
        <button class="btn danger" id="resetBtn">Reset</button>
      </div>
    </header>

    <section class="panel">
      <form class="add" id="addForm">
        <input id="title" placeholder="Add a task..." required/>
        <input id="due" type="date"/>
        <select id="priority">
          <option value="med">Medium</option>
          <option value="high">High</option>
          <option value="low">Low</option>
        </select>
        <button class="btn primary" type="submit">Add</button>
      </form>

      <div class="filters">
        <button class="btn" data-filter="all">All</button>
        <button class="btn" data-filter="active">Active</button>
        <button class="btn" data-filter="done">Completed</button>
        <button class="btn" data-sort="priority">Sort by Priority</button>
        <button class="btn" data-sort="date">Sort by Date</button>
        <input id="search" class="search" placeholder="Search..."/>
        <span id="count" class="btn">0 items</span>
      </div>

      <div id="list" class="list"></div>
      <div id="empty" class="empty">No tasks yet üöÄ</div>
    </section>

    <footer>
      <div>Made with ‚ù§Ô∏è Your Personlaised Task Manager</div>
      <div id="status"></div>
    </footer>
  </div>

  <script>
    const STORAGE_KEY="todoflow.v2";
    let items=JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");
    let filter="all",query="",sort="none";

    const listEl=document.getElementById("list");
    const emptyEl=document.getElementById("empty");
    const countEl=document.getElementById("count");
    const titleEl=document.getElementById("title");
    const dueEl=document.getElementById("due");
    const priorityEl=document.getElementById("priority");
    const searchEl=document.getElementById("search");
    const exportBtn=document.getElementById("exportBtn");
    const importFile=document.getElementById("importFile");
    const clearDoneBtn=document.getElementById("clearDoneBtn");
    const resetBtn=document.getElementById("resetBtn");
    const toggleTheme=document.getElementById("toggleTheme");
    const statusEl=document.getElementById("status");

    function save(){localStorage.setItem(STORAGE_KEY,JSON.stringify(items));}
    function uid(){return Math.random().toString(36).slice(2);}
    function today(){return new Date().toISOString().slice(0,10);}
    function fmt(d){return d?new Date(d).toLocaleDateString():"";}
    function isOverdue(d){return d && d<today();}

    function render(){
      let filtered=items.filter(it=>filter==="all"?true:filter==="active"? !it.done:it.done)
                        .filter(it=>it.title.toLowerCase().includes(query.toLowerCase()));
      if(sort==="priority"){
        const order={high:1,med:2,low:3};
        filtered.sort((a,b)=>order[a.priority]-order[b.priority]);
      }
      if(sort==="date"){
        filtered.sort((a,b)=>(a.due||"9999-12-31").localeCompare(b.due||"9999-12-31"));
      }
      listEl.innerHTML="";
      filtered.forEach(it=>listEl.appendChild(renderItem(it)));
      emptyEl.style.display=filtered.length?"none":"block";
      countEl.textContent=`${items.length} items`;
      save();
    }

    function renderItem(it){
      const card=document.createElement("div");
      card.className="item";

      const top=document.createElement("div");
      top.className="top-row";

      const check=document.createElement("div");
      check.className="checkbox"+(it.done?" checked":"");
      check.onclick=()=>{it.done=!it.done;render();};

      const title=document.createElement("div");
      title.className="title"+(it.done?" done":"");
      title.textContent=it.title;
      title.contentEditable=true;
      title.onblur=()=>{it.title=title.textContent.trim()||it.title;save();};
      title.onkeydown=e=>{if(e.key==="Enter"){e.preventDefault();title.blur();}};

      top.append(check,title);

      const meta=document.createElement("div");
      meta.className="meta";
      meta.innerHTML=`<span>Priority: ${it.priority}</span><span>${it.due?("Due: "+fmt(it.due)):"No date"}</span>`;

      const actions=document.createElement("div");
      actions.className="actions";
      const toggleBtn=document.createElement("button");
      toggleBtn.className="btn";
      toggleBtn.textContent=it.done?"Mark Active":"Mark Done";
      toggleBtn.onclick=()=>{it.done=!it.done;render();};
      const del=document.createElement("button");
      del.className="btn danger";
      del.textContent="Delete";
      del.onclick=()=>{items=items.filter(x=>x.id!==it.id);render();};
      actions.append(toggleBtn,del);

      card.append(top,meta,actions);
      return card;
    }

    document.getElementById("addForm").onsubmit=e=>{
      e.preventDefault();
      if(!titleEl.value.trim())return;
      items.unshift({id:uid(),title:titleEl.value.trim(),due:dueEl.value||"",priority:priorityEl.value,done:false});
      titleEl.value="";dueEl.value="";priorityEl.value="med";
      render();status("Task added");
    };
    document.querySelectorAll("[data-filter]").forEach(btn=>btn.onclick=()=>{filter=btn.dataset.filter;render();});
    document.querySelectorAll("[data-sort]").forEach(btn=>btn.onclick=()=>{sort=btn.dataset.sort;render();});
    searchEl.oninput=()=>{query=searchEl.value;render();};
    exportBtn.onclick=()=>{
      const blob=new Blob([JSON.stringify(items,null,2)],{type:"application/json"});
      const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="tasks.json";a.click();};
    importFile.onchange=async e=>{
      const f=e.target.files[0];if(!f)return;
      const text=await f.text();items=JSON.parse(text);render();};
    clearDoneBtn.onclick=()=>{items=items.filter(x=>!x.done);render();};
    resetBtn.onclick=()=>{if(confirm("Reset all tasks?")){items=[];render();}};
    function status(msg){statusEl.textContent=msg;setTimeout(()=>statusEl.textContent="",2000);}

    // Theme toggle
    if(localStorage.getItem("theme")==="dark"){document.body.classList.add("dark");toggleTheme.textContent="‚òÄÔ∏è Light";}
    toggleTheme.onclick=()=>{
      document.body.classList.toggle("dark");
      const dark=document.body.classList.contains("dark");
      localStorage.setItem("theme",dark?"dark":"light");
      toggleTheme.textContent=dark?"‚òÄÔ∏è Light":"üåô Dark";
    };

    render();
  </script>
</body>
</html>
